## 4.4 智能体技能：能力扩展规范

**智能体技能（Agent Skills）** 是 Anthropic 主导的开放格式规范，用于扩展 AI 智能体的能力和专业知识。它提供了一种轻量级、可移植的方式来封装领域知识和工作流程。

### 4.4.1 什么是 Agent Skills

Skills 是一种简单的开放格式，用于赋予智能体新的能力和专业知识。与 MCP 提供系统连接能力不同，Skills 专注于 **过程性知识** 的封装。

> MCP 是 **通道**，技能是 **智慧**。
> 
> MCP 解决"通过什么做"，技能解决"如何做"。

Skills 为智能体系统带来了以下核心价值：

- **领域专业知识**：将法律审查流程、数据分析管道等专业知识封装为可复用指令
- **新能力扩展**：赋予智能体创建演示文稿、构建 MCP 服务器、分析数据集等能力
- **可重复工作流**：将多步骤任务转化为一致、可审计的工作流程
- **跨平台互操作**：在不同 Skills 兼容的智能体产品间复用相同技能

### 4.4.2 Skills 工作机制

Skills 采用三阶段加载机制：

```mermaid
flowchart LR
    a["1. 发现 (Discovery)"] --> b["2. 激活 (Activation)"] --> c["3. 执行 (Execution)"]
    
    subgraph discovery ["启动阶段"]
        a
        d["加载名称 + 描述"]
    end
    
    subgraph activation ["匹配阶段"]
        b
        e["加载完整 SKILL.md"]
    end
    
    subgraph execution ["执行阶段"]
        c
        f["按需加载脚本/参考/资源"]
    end
```

图 4-11：Skills 三阶段加载机制 (Three-Stage Loading Mechanism of Skills)

1. **发现（Discovery）**：启动时仅加载每个技能的 name 和 description，足以判断其相关性
2. **激活（Activation）**：当任务匹配某个技能的描述时，将完整 SKILL.md 指令加载到上下文
3. **执行（Execution）**：智能体按照指令执行，按需加载引用的文件或执行捆绑的脚本

### 4.4.3 Skill 目录结构

一个 Skill 的标准目录结构如下：

```mermaid
mindmap
    root((skill-name/))
        SKILL.md["SKILL.md<br>(必需：指令 + 元数据)"]
        scripts/["scripts/<br>(可选：可执行代码)"]
        references/["references/<br>(可选：参考文档)"]
        assets/["assets/<br>(可选：模板、资源)"]
```

| 目录/文件 | 说明 |
|-----------|------|
| `SKILL.md` | **必需**。包含元数据和详细指令 |
| `scripts/` | 可执行脚本，应自包含或清晰声明依赖 |
| `references/` | 技术参考文档，如 REFERENCE.md、领域专用文档 |
| `assets/` | 模板、图片、数据文件等资源 |

### 4.4.4 SKILL.md 格式规范

SKILL.md 由 YAML Frontmatter 和 Markdown 正文两部分组成。

#### 前置元数据（必需）

以下是一个完整的 YAML Frontmatter 示例：

```yaml
---
name: pdf-processing
description: Extract text and tables from PDF files, fill forms, merge documents.
license: Apache-2.0
compatibility: Designed for Claude Code
allowed-tools: Bash(git:*) Bash(jq:*) Read
metadata:
  author: example-org
  version: "1.0"
---
```

| 字段 | 要求 | 说明 |
|------|------|------|
| `name` | 必需 | 1-64 字符，仅小写字母、数字和连字符 |
| `description` | 必需 | 1-1024 字符，描述功能和使用场景 |
| `license` | 可选 | 许可证信息 |
| `compatibility` | 可选 | 环境要求，如"需要 git、docker" |
| `allowed-tools` | 可选 | 预授权工具列表 |
| `metadata` | 可选 | 自定义键值对 |

#### 正文内容

正文采用 Markdown 格式，应包含：

- 分步骤指令
- 输入输出示例
- 常见边界情况处理

以下是一个 SKILL.md 正文的典型结构示例：

```markdown
# PDF Processing

## When to use this skill

Use this skill when the user needs to work with PDF files...

## How to extract text

1. Use pdfplumber for text extraction...

## How to fill forms

...
```

### 4.4.5 渐进式披露

Skills 采用三层加载机制优化上下文使用：

| 层级 | 内容 | Token 预算 | 加载时机 |
|------|------|-----------|---------|
| 元数据 (Metadata) | name + description | ~100 tokens | 启动时加载所有 Skills |
| 指令 (Instructions) | 完整 SKILL.md 正文 | <5000 tokens（建议） | 任务匹配时激活 |
| 资源 (Resources) | scripts/、references/、assets/ | 按需 | 执行时按需加载 |

这种设计确保：

- 启动时上下文开销极小
- 仅在需要时加载详细指令
- 大型资源文件按需获取

### 4.4.6 Skills 与 MCP 的协同

技能和 MCP 是互补的：技能定义"做什么"和"怎么做"，MCP 提供"用什么工具做"。

#### 协同架构

具体示例如下：

```mermaid
graph TD
    subgraph Workflow [智能体工作流]
        Skill[/"Skill<br>定义：工作流程、业务规则、质量标准<br>'查询客户数据时，先检查 CRM，再交叉验证 Slack'"/]
    end
    
    subgraph Execution [调用多个 MCP 服务器执行]
        S1[Salesforce MCP]
        S2[Slack MCP]
        S3[Google Drive]
        S4[Notion MCP]
    end
    
    Skill --> S1
    Skill --> S2
    Skill --> S3
    Skill --> S4
```

图 4-12：Skills 与 MCP 协同架构 (Collaboration Architecture of Skills and MCP)

#### 边界划分

| 维度 | MCP 负责 | 技能负责 |
|------|---------|------------|
| 核心 | 连接能力 | 领域知识 |
| 内容 | API 格式、查询语法 | 工作流程、业务规则 |
| 指令 | 工具使用提示 | 多工具编排逻辑 |
| 粒度 | 单个服务 | 跨服务流程 |

**经验法则**：

- MCP 指令覆盖 **如何正确使用服务器及其工具**
- Skill 指令覆盖 **如何在特定流程或多服务器工作流中使用它们**

#### 实际案例

**案例 1：财务分析 Skill**

```markdown
# Comparable Company Analysis Skill

## 工作流程

1. 从 S&P Capital IQ MCP 拉取财务数据
2. 从 Daloopa MCP 获取补充指标
3. 应用估值方法论（Skill 定义）
4. 格式化输出符合合规要求（Skill 定义）
```

**案例 2：会议准备 Skill（Notion 官方）**

```markdown
# Meeting Intelligence Skill

## 工作流程

1. 通过 Notion MCP 搜索相关项目页面
2. 通过 Notion MCP 获取历史会议记录
3. 整理为两份文档：内部预读 + 外部议程
4. 通过 Notion MCP 保存到指定位置
```

#### Skills 生态与企业部署

##### 组织级管理

自 2025 年 12 月起，Anthropic 推出了企业级 Skills 管理功能，使 Skills 从个人工具升级为组织资产。

**集中配置能力**：

- Claude Team 和 Enterprise 计划管理员可从管理设置集中配置 Skills
- 管理员配置的 Skills 默认为所有用户启用
- 用户仍可选择关闭个别 Skills 以自定义体验
- 确保团队使用一致、经批准的工作流

**部署优势**：

- 统一标准：整个组织遵循相同的工作流程
- 质量控制：IT 团队审核和批准 Skills
- 快速推广：一次配置，全员可用
- 灵活性：用户保留个性化选择权

#### Skills 目录与合作伙伴

Anthropic 在 claude.com/connectors 建立了不断增长的合作伙伴 Skills 集合，覆盖主流企业工具：

| 合作伙伴 | Skills 类型 | 核心价值 |
|---------|-----------|---------|
| **Notion** | Meeting Intelligence | 会议准备、页面管理 |
| **Canva** | Campaign Creation | 多平台营销活动、品牌一致性 |
| **Figma** | Design to Code | 设计理解与代码转换 |
| **Atlassian** | Jira/Confluence Workflows | 需求转工单、状态报告、知识挖掘 |
| **Cloudflare** | Agent Deployment | 一键部署 AI Agents 和 MCP 服务器 |
| **Vercel** | Deploy Skill | 从想法到生产环境的快速部署 |
| **Zapier** | Workflow Automation | 跨数千应用的规模化执行 |
| **Sentry** | Developer Context | 开发者上下文聚焦工作流 |

#### 行业合作伙伴反馈

> "Skills 让我们能够一键将 AI Agents 和 MCP 服务器部署到 Cloudflare。我们很高兴人们能通过快速聊天将应用部署到 Region:Earth。"  
> — **Kate Reznykova**, Cloudflare Agents 工程经理

> "Figma Skills 帮助团队用 Claude Code 构建更高质量、差异化的产品。现在 Claude 能更好地理解 Figma 设计的上下文、细节和意图，并将这些设计准确一致地转换为代码。"  
> — **Emil Sjölander**, Figma 开发工具总监

> "通过结合 Skills 和 Zapier MCP，组织获得了既知道该怎么做、又能可靠执行的 AI。Skills 编码可重复的流程和最佳实践；Zapier MCP Tools 在数千个应用中大规模运行它们。"  
> — **Lisa Chapello**, Zapier AI 平台负责人

> "Atlassian 的 Skills 将我们数十年的团队协作专业知识和最佳实践带给 Claude。现在 Claude 不仅能看到 Jira 票据或 Confluence 页面，还知道该做什么：将需求转为待办事项、生成状态报告、挖掘公司知识、分类问题等。"  
> — **Josh Devenny**, Atlassian Rovo Skills 产品负责人

##### 创建与编辑体验优化

**简化创建流程**：

- **描述即创建**：描述需求，Claude 帮助构建 Skill
- **直接编写**：直接编写指令文件
- **文件夹上传**：上传完整的 Skill 文件夹结构
- **Skill-creator 工具**：处理复杂工作流的官方工具

**完整预览功能**：

- 启用前查看 Skill 完整内容
- 理解 Skill 具体做什么
- 审核指令的安全性和合理性

**Claude 辅助编辑**：

- Claude 可帮助编辑现有 Skills
- 根据反馈优化指令
- 迭代改进工作流

##### 跨平台可用性

Agent Skills 作为开放标准发布，支持多平台使用：

**Claude Apps**：

- 浏览 Skills 目录
- 通过 Settings → Capabilities → Skills 启用
- 个人或组织级配置

**Claude Code**：

- 从插件目录安装
- 将 Skills 检入代码仓库
- 与项目代码一起版本控制

**Claude Developer Platform (API)**：

- 通过 `/v1/skills` 端点使用
- 编程式集成到应用中
- 支持动态加载和管理

> [!NOTE]
> **前置要求**：使用 Skills 需要启用 Code Execution 和 File Creation 能力。

### 4.4.7 最佳实践

在开发和使用 Agent Skills 时，遵循经过验证的最佳实践可以显著提高技能的质量和可用性，避免常见的陷阱。

#### Skill 设计原则

- **功能聚焦**：每个 Skill 专注于一个明确的领域或工作流
- **自文档化**：任何人阅读 SKILL.md 都能理解其功能
- **可移植性**：Skills 就是文件，易于编辑、版本控制和分享

#### 避免常见问题

- **避免指令冲突**：如果 MCP 指定返回 JSON，而 Skill 要求 Markdown 表格，智能体需要猜测。让 MCP 处理连接，Skill 处理呈现
- **保持复用性**：一个 MCP 服务器可支持多个 Skills；一个 Skill 可编排多个 MCP 服务器
- **利用渐进式加载**：将详细参考资料放在 references/ 目录，仅在需要时加载

#### 验证工具

使用 [ASK (Agent Skills Kit)](https://github.com/yeasy/ask) 验证 Skill 格式：

```bash
ask skill check ./my-skill
```

> [!TIP]
> **相关资源**：
> - Agent Skills 规范：https://agentskills.io
> - 官方示例：https://github.com/anthropics/skills
> - 创建 Skills 最佳实践：https://platform.claude.com/docs/en/agents-and-tools/agent-skills/best-practices

---

**下一节**: [浏览器自动化与计算机操作](4.5_browser.md)
